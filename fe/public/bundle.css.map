{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../src/App.svelte"
  ],
  "sourcesContent": [
    "<script>\n  import { kho } from \"./stores.js\";\n  import { filterListObj } from \"./utils.js\";\n  import { tamdskh } from \"./tamdskh.js\";\n  $kho.namhoso = 2019;\n  $kho.dskh = tamdskh;\n  $kho.progress = 0;\n  $kho.showProgress = true;\n  $kho.curbang = 0;\n  $kho.tongbang = 4;\n\n  //api\n  const API_URL = \"http://localhost:8888/api1108/\";\n\n  let dsnam = [2020, 2019, 2018, 2017, 2016];\n  $kho.namhoso = 2019;\n  //nhan data tu server\n  function xemHoso() {\n    let apiurl = API_URL + \"hoso/\";\n    axios({\n      method: \"get\",\n      url: \"http://localhost:8888/api1108/hoso/\",\n      responseType: \"json\",\n      responseEncoding: \"utf8\",\n      onDownloadProgress: progressEvent => {\n        let percentCompleted = parseInt(\n          Math.round((progressEvent.loaded * 100) / progressEvent.total)\n        );\n        $kho.progress = percentCompleted;\n        console.log(\"$kho.progress=\" + $kho.progress);\n      }\n    }).then(response => {\n      let dulieu = response.data;\n      console.log(\"response.data=\" + dulieu);\n      if (dulieu !== null || dulieu !== undefined || dulieu !== \"\") {\n        $kho.dskh = dulieu.hoso;\n        console.log(\"$dulieu.hoso=\" + dulieu.hoso);\n        console.log(\"$dulieu.info=\" + dulieu.info);\n      }\n    });\n  }\n  // tim kiem\n  $kho.dsloc = [];\n  let dsLocNhom = [];\n  let stim = \"\";\n  let dstim = [];\n  let curdstim = 0;\n  function addDsTim(event) {\n    if (event.key === \"Enter\" && stim.length > 0) {\n      stim = stim.trim();\n      let dai = dstim.length;\n      let data = [stim];\n      for (let i = 0; i < dai; i++) {\n        if (dstim[i] !== stim) {\n          data.push(dstim[i]);\n        }\n      }\n      dstim = data;\n      stim = \"\";\n    }\n  }\n  function xoaDstim() {\n    let dai = dstim.length;\n    let data = [];\n    for (let i = 0; i < dai; i++) {\n      if (i !== curdstim) {\n        data.push(dstim[i]);\n      }\n    }\n    dstim = data;\n  }\n  function locNhom(nhom) {\n    let l = nhom.length || 0;\n    let data = $kho.dskh;\n    if (l > 0) {\n      for (let i = 0; i < l; i++) {\n        let s = nhom[i];\n        data = filterListObj(data, s);\n      }\n    }\n    return data;\n  }\n  $: dsLocNhom = locNhom(dstim);\n  $: $kho.dsloc = filterListObj(dsLocNhom, stim);\n  // phan trang\n  $kho.hs_trang = 3;\n  $kho.tongtrang = 0;\n  $kho.curtrang = 0;\n  function tinhTongTrang(dsloc) {\n    let a = dsloc !== undefined ? dsloc.length : 0;\n    let l = a % $kho.hs_trang > 0 ? 1 : 0;\n    let c = parseInt(a / $kho.hs_trang);\n    let t = c > 0 ? c + l : 0;\n    return t;\n  }\n  $: $kho.tongtrang = tinhTongTrang($kho.dsloc);\n  $: $kho.curtrang =\n    $kho.curtrang > $kho.tongtrang ? $kho.tongtrang : $kho.curtrang;\n  $: $kho.hs_start = $kho.curtrang * $kho.hs_trang;\n  $: $kho.hs_stop = $kho.hs_start + $kho.hs_trang - 1;\n  //hoso sua\n  $kho.hososua = {};\n  let editGroup = false;\n  let rowCur = 0;\n  let rowEdit = -1;\n  let hosocu = {};\n  function btnSave() {\n    editGroup = false;\n    rowEdit = -1;\n    //kiem tra hososua so voi h sơ cũ\n    let tam = {};\n    for (let k in $kho.hososua) {\n      if ($kho.hososua[k].length > 0 && $kho.hososua[k] !== hosocu[k]) {\n        tam[k] =\n          typeof $kho.hososua[k] === \"string\"\n            ? $kho.hososua[k].trim()\n            : $kho.hososua[k];\n      }\n    }\n    if (tam.length > 0) {\n      $kho.hososua = JSON.parse(JSON.stringify(tam));\n      // update client dskh\n      let dai = $kho.dskh.length;\n      for (let i = 0; i < dai; i++) {\n        let a = $kho.dskh[i];\n        if (a.mahoso === hosocu.mahoso) {\n          for (let k in $kho.hososua) {\n            if (a.hasOwnProperty(k)) {\n              a[k] = $kho.hososua[k];\n            }\n          }\n        }\n      }\n      // update server\n      let tincangui = $kho.hososua;\n      postServer(tincangui);\n    }\n    // init data\n    $kho.hososua = {};\n  }\n</script>\n\n<style>\n  section {\n    display: flex;\n    flex-flow: column nowrap;\n    justify-content: space-between;\n    width: 100%;\n    height: 100vh;\n  }\n  main {\n    flex: 1 1 auto;\n  }\n</style>\n\n<section>\n  <header class=\"container-fluid\">\n    <div class=\"row justify-content-center text-primary\">\n      <div class=\"col-auto\">\n        <h3>DANH SÁCH KHÁCH HÀNG - NHẬN ĐƠN NĂM&nbsp;</h3>\n      </div>\n      <div class=\"col-auto\">\n        <div class=\"input-group\">\n          <select\n            class=\"custom-select\"\n            id=\"selectnam\"\n            bind:value={$kho.namhoso}>\n            {#each dsnam as namlamviec}\n              <option value={namlamviec}>{namlamviec}</option>\n            {/each}\n          </select>\n        </div>\n      </div>\n      <div class=\"col-auto\">\n        <button\n          class=\"btn btn-outline-primary btn-rounded\"\n          type=\"button\"\n          on:click={xemHoso}>\n          <i class=\"fa fa-sync-alt\" />\n        </button>\n      </div>\n    </div>\n    {#if $kho.showProgress}\n      <div class=\"row\">\n        <div class=\"col\">\n          <div class=\"progress\">\n            <div\n              class=\"progress-bar progress-bar-striped progress-bar-animated\n              bg-info\"\n              role=\"progressbar\"\n              aria-valuenow={$kho.progress}\n              aria-valuemin=\"0\"\n              aria-valuemax=\"100\"\n              style=\"width: {$kho.progress}%\">\n              {$kho.progress}%\n            </div>\n          </div>\n        </div>\n      </div>\n    {/if}\n  </header>\n  <main>\n    <!-- search search search search         -----------------------                                           -->\n    <div class=\"container-fluid\">\n      <div class=\"row\">\n        <div class=\"col border border-primary\">\n          <div class=\"row\">\n            <div class=\"col\">\n              {#each dstim as item, id}\n                <button\n                  type=\"button\"\n                  class=\"btn btn-outline-info\"\n                  on:mouseover={() => (curdstim = id)}\n                  on:click|preventDefault={xoaDstim}>\n                  {item}\n                </button>\n              {/each}\n            </div>\n            <div class=\"col-auto\">\n              <button class=\"btn\" on:click={() => (dstim = [])}>\n                <i class=\"fa fa-trash fa-lg\" />\n                Xóa hết\n              </button>\n            </div>\n          </div>\n        </div>\n        <div class=\"col-3\">\n          <input\n            class=\"col\"\n            type=\"search\"\n            bind:value={stim}\n            on:keydown={addDsTim}\n            placeholder=\"Tìm ... (không phân biệt chữ hoa hay thường)\" />\n        </div>\n      </div>\n    </div>\n    <!-- hoso         -----------------------                                           -->\n    <div class=\"container-fluid\">\n      <div class=\"table-responsive\">\n        <table class=\"table table-hover\">\n          <thead>\n            <tr>\n              <th scope=\"col\">STT</th>\n              <th scope=\"col\">Mã hồ sơ</th>\n              <th scope=\"col\">Số hồ sơ</th>\n              <th scope=\"col\">Khách hàng</th>\n              <th scope=\"col\">Địa chỉ</th>\n              <th scope=\"col\">Liên hệ</th>\n              <th scope=\"col\">Mô tả</th>\n              <th scope=\"col\">Trở ngại</th>\n              <th scope=\"col\">Tái nhập</th>\n              <th scope=\"col\">Tái thi công</th>\n              <th scope=\"col\">Hoàn tiền</th>\n            </tr>\n          </thead>\n          <tbody>\n            {#each $kho.dsloc as hs, stt}\n              {#if stt >= $kho.hs_start && stt <= $kho.hs_stop}\n                <tr on:mouseover={() => (rowCur = stt)}>\n                  {#if editGroup && rowCur === stt && rowEdit === stt}\n                    <th scope=\"row\">\n                      <button\n                        class=\"btn btn-outline-secondary\"\n                        type=\"button\"\n                        on:click={btnSave}>\n                        <i class=\"fa fa-save\" />\n                        {stt + 1}\n                      </button>\n                    </th>\n                    <td>{hs.mahoso}</td>\n                    <td>\n                      <input bind:value={hs.sohoso} />\n                    </td>\n                    <td>\n                      <input bind:value={hs.khachhang} />\n                    </td>\n                    <td>\n                      <input bind:value={hs.diachi} />\n                    </td>\n                    <td>\n                      <input bind:value={hs.lienhe} />\n                    </td>\n                    <td>\n                      <input bind:value={hs.mota} />\n                    </td>\n                    <td>\n                      <input bind:value={hs.trongai} />\n                    </td>\n                    <td>\n                      <input bind:value={hs.tainhap} />\n                    </td>\n                    <td>\n                      <input bind:value={hs.taithicong} />\n                    </td>\n                    <td>\n                      <input bind:value={hs.hoantien} />\n                    </td>\n                  {:else}\n                    <th scope=\"row\">\n                      <button\n                        class=\"btn btn-outline-secondary\"\n                        type=\"button\"\n                        on:click={() => {\n                          editGroup = true;\n                          rowEdit = stt;\n                          hosocu = JSON.parse(JSON.stringify(hs));\n                        }}>\n                        <i class=\"fa fa-edit\" />\n                        {stt + 1}\n                      </button>\n                    </th>\n                    <td>{hs.mahoso}</td>\n                    <td>{hs.sohoso}</td>\n                    <td>{hs.khachhang}</td>\n                    <td>{hs.diachi}</td>\n                    <td>{hs.lienhe}</td>\n                    <td>{hs.mota}</td>\n                    <td>{hs.trongai}</td>\n                    <td>{hs.tainhap}</td>\n                    <td>{hs.taithicong}</td>\n                    <td>{hs.hoantien}</td>\n                  {/if}\n                </tr>\n              {/if}\n            {/each}\n          </tbody>\n        </table>\n      </div>\n    </div>\n\n  </main>\n  <footer>\n    <hr />\n    <div class=\"container\">\n      <div class=\"row justify-content-between\">\n        <div class=\"col-auto\">\n          Hiện có {$kho.dsloc.length}/{$kho.dskh.length} hồ sơ\n        </div>\n        {#if $kho.tongtrang > 0}\n          <div class=\"col-4 chontrang\">\n            <div class=\"row\">\n              <input\n                class=\"col\"\n                type=\"range\"\n                bind:value={$kho.curtrang}\n                min=\"0\"\n                max={$kho.tongtrang - 1} />\n            </div>\n            <div class=\"row\">\n              <div class=\"col-2\">Trang</div>\n              <div class=\"col-2\">\n                <button\n                  class=\"btn btn-outline-secondary\"\n                  type=\"button\"\n                  on:click={() => ($kho.curtrang > 0 ? $kho.curtrang-- : 0)}>\n                  <i class=\"fa fa-caret-square-left\" />\n                </button>\n              </div>\n              <input class=\"col-4\" type=\"number\" bind:value={$kho.curtrang} />\n              <div class=\"col-2\">\n                <button\n                  class=\"btn btn-outline-secondary\"\n                  type=\"button\"\n                  on:click={() => ($kho.curtrang < $kho.tongtrang - 1 ? $kho.curtrang++ : $kho.tongtrang - 1)}>\n                  <i class=\"fa fa-caret-square-right\" />\n                </button>\n              </div>\n              <div class=\"col-2\">/{$kho.tongtrang}</div>\n            </div>\n          </div>\n        {/if}\n        {#if $kho.tongbang > 0}\n          <div class=\"col-4 chonbang\">\n            <div class=\"row\">\n              <input\n                class=\"col\"\n                type=\"range\"\n                bind:value={$kho.curbang}\n                min=\"0\"\n                max={$kho.tongbang - 1} />\n            </div>\n            <div class=\"row\">\n              <div class=\"col-2\">Bang</div>\n              <div class=\"col-2\">\n                <button\n                  class=\"btn btn-outline-secondary\"\n                  type=\"button\"\n                  on:click={() => ($kho.curbang > 0 ? $kho.curbang-- : 0)}>\n                  <i class=\"fa fa-caret-square-left\" />\n                </button>\n              </div>\n              <input class=\"col-4\" type=\"number\" bind:value={$kho.curbang} />\n              <div class=\"col-2\">\n                <button\n                  class=\"btn btn-outline-secondary\"\n                  type=\"button\"\n                  on:click={() => ($kho.curbang < $kho.tongbang - 1 ? $kho.curbang++ : $kho.tongbang - 1)}>\n                  <i class=\"fa fa-caret-square-right\" />\n                </button>\n              </div>\n              <div class=\"col-2\">/{$kho.tongbang}</div>\n            </div>\n          </div>\n        {/if}\n        <div class=\"col-auto\">\n          <button\n            class=\"btn btn-outline-secondary\"\n            type=\"button\"\n            on:click={() => {\n              $kho.dskh = [];\n            }}>\n            <i class=\"fa fa-plus\" />\n          </button>\n        </div>\n      </div>\n    </div>\n  </footer>\n</section>\n"
  ],
  "names": [],
  "mappings": "AA+IE,OAAO,eAAC,CAAC,AACP,OAAO,CAAE,IAAI,CACb,SAAS,CAAE,MAAM,CAAC,MAAM,CACxB,eAAe,CAAE,aAAa,CAC9B,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,KAAK,AACf,CAAC,AACD,IAAI,eAAC,CAAC,AACJ,IAAI,CAAE,CAAC,CAAC,CAAC,CAAC,IAAI,AAChB,CAAC"
}